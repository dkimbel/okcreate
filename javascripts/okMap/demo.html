<!doctype html>
<!--[if lt IE 7]><html class="ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]><html class="ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]><html class="ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>okMap</title>
  <link href="../../stylesheets/lib/grid_12.css" rel="stylesheet" type="text/css" media="screen">
  <link href="../../stylesheets/application.css" rel="stylesheet" type="text/css" media="screen">
  <link href="../../assets/demo.css" rel="stylesheet" type="text/css" media="screen">
  <link href="demo.css" rel="stylesheet" type="text/css" media="screen">
  <script src="../../assets/rainbow-custom.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->  
  <style>
    #map {
      width: 100%;
      height: 400px;
    }
  </style>

  <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <!-- Plugin -->
  <script src="jquery.okMap.core.js"></script>
  <script src="jquery.okMap.ui.js"></script>
</head>
<body>

  <div id="doc">
    <header>
      <h1>okMap</h1>
    </header>

    <article id="main" class='container'>
      <div class='twelve'>
        <p class='box'>Convience Wrapper for Google Maps</p>
        <h2>Demonstration</h2>
        <div id='map'></div>
          <h2>Putting stuff on the map</h2>
          <p>okMap is a wrapper for Google Maps. It takes a list of places and manages their representation on the map (via Markers)</p>
          <p>
            You can get places on the map in three ways:
          </p>
          <ol>
            <li>
              Pass in a array of places during plugin initialization
              <pre>
                <code data-language='javascript'>
var map = $(".map").okMap({places: [...places]});
                </code>
              </pre>
            </li>
            <li>
              Inline JSON on the map object itself (this can be combined with
              the previous method, the places will be a union of the two
              sources). In fact, all options can be specified inline as a
              data-attribute. Note that you can change the dataAttribute name
              by passing in the dataAttributeName option during plugin
              initialization.
              <pre>
                <code data-language='html'>
&lt;div id='map' data-map='{"places" : [...places]}'&gt;&lt;/div&gt;
                </code>
              </pre>
            </li>
            <li>
              Call one of the API methods: <code>append</code> or <code>set</code>
              <pre>
                <code data-language='javascript'>
var map = $(".map").okMap();
map.okMap('append', places); // Where places is one or more places or an array of places
map.okMap('set', places); // Where places is one or more places or an array of places
                </code>
              </pre>
              The difference between <code>append</code> and <code>set</code>
              is that set will clear existing places from the map before
              appending the places.
            </li>
          </ol>
          <h2>Removing stuff from the map</h2>
          <p>
            You can remove places from the map using the <code>remove</code> API method.
          </p>
          <pre>
            <code data-language='javascript'>
var map = $(".map").okMap();
map.okMap('remove', places); // Remove given places from the map
map.okMap('remove'); // Called without arguments ALL places are removed
            </code>
          </pre>
          <p>
            <code>places</code> here can either be one or more places, or one or more IDS of places or an array of either places or IDS or a mix of both.
          </p>
          <p>
            IDs are generated internally by okMap in sequential order. The
            first place added gets an id of "<code>p0</code>", then
            "<code>p1</code>" and so on. So as to not interfere with any other
            properties, the id is stored on the <code>_id</code> property of
            each place.
          </p>
          <p>
            Since the ids are generated by okMap, and it may not be easy to access, there is a convience function <code>filter</code> that takes a filter
            function and returns all the places that return true. The results of this can be directly passed to the remove method.
          </p>
          <pre>
            <code data-language='javascript'>
var map = $(".map").okMap(),
    toRemove = map.okMap('filter', function(){
      return this.category == 'restaurant';
    });
map.okMap('remove', toRemove);
            </code>
          </pre>
          <p>
            Additionally, there are two methods to remove places within certain boundaries <code>removeWithin</code> <code>removeHidden</code>.
            <code>removeWithin</code> takes two <code>google.maps.LatLng</code> objects and removes any places within that boundary. <code>removeHidden</code>
            just removes any places that aren't currently visible on the map
          </p>
          <pre>
            <code data-language='javascript'>
var map = $(".map").okMap();
map.okMap('removeHidden');
map.okMap('removeWithin', LatLng1, LatLng2);
            </code>
          </pre>
          <h2>Places</h2>
        <p>
          The simplest instance of a place is simply an object that we can derive a location from. There are three ways to specify
          a location:
        </p>
        <pre>
          <code data-language='javascript'>
// Via a latitude and longitude
var place = { lat: Float, lng: Float }
          </code>
        </pre>
        <pre>
          <code data-language='javascript'>
// Via a textual address that will be geocoded by the Google Maps API
var place = { address: String }
          </code>
        </pre>
        <pre>
          <code data-language='javascript'>
// Via a google.maps.LatLng object
var place = { latLng: google.maps.LatLng }
          </code>
        </pre>
        <p>
          In addition to a location, there are two other properties that okMap will take advantage of when generating markers:
        </p>
        <pre>
          <code data-language='javascript'>
var place = {
  events: {}, // A map of events to bind to this particular place
  icon: "//path/to/icon.png" // Image to replace the default google map icon
}
          </code>
        </pre>
        <p>
          All other properties will simply be passed in unaltered.
        </p>
        <h2>Events</h2>
        <p>
          Events can be specified globally or on a per-place basis. Events specified on the place will override the plugin-wide events.
        </p>
        <pre>
          <code data-language='javascript'>
var map = $(".map").okMap({
  events: {
    event: 'eventHandler'
  },
  scope: window, // It's advisable to not scope it to the window
  places: [{
    event: {
      eventName: 'anotherEventHandler' // This will override the default eventHanlder for THIS place only
    },
    latLng: new google.maps.LatLng(37.757687,-122.437477)
  }]
});

// Event Handlers receive the place that was clicked and the original google map event
function eventHandler(place,event) {
  // Do stuff...
}
          </code>
        </pre>
        <p>
          You may be wondering how eventHandlers are called. Event handlers are
          assumed to be properties of the <code>scope</code> parameter, which by default
          is just <code>window</code>. So in the previous example the
          <code>eventHandler</code> function will be called when the
          <code>eventName</code> is triggered. You shouldn't leave it as
          window. Globals are bad.
          <br/>
          <br/>
          Map events can be one of: <code>'click', 'dblclick', 'mouseup', 'mousedown', 'mouseover', 'mouseout'</code>.
        </p>
        <h3>UI</h3>
        <p>
          Currently okMap provides one simple UI enhancement, which is a custom implementation
          of an <a href='https://developers.google.com/maps/documentation/javascript/reference#OverlayView'>OverlayView</a>,
          called an <strong>infoPane</strong>. It relies either on an existing in-page
          element or a template passed in on initialization to render the OverlayView. 
          The infoPane is then controlled by binding an event to
          <code>infoPane</code>. Additionally, you can provide an
          <code>render</code> function which will be called when the event is
          triggered, this will allow you to customize the infoPane.
        </p>
        <p>
          infoPanes bind a click event to the any element with a <code>data-close</code> attribute. You can however
          manually close an infoPane by calling the close method: <code>$(map).okMap('infoPane').close()</code>.
        </p>
        <p>
          Note that the scope option must be omitted (to scope to the map itself) for this to work
        </p>
        <pre>
          <code data-language='html'>
&lt;div class='infoPane'&gt;&lt;div&gt;
          </code>
        </pre>
        <pre>
          <code data-language='javascript'>
var map = $(".map").okMap({
  click: 'infoPane',
  infoPane: {
    selector: ".infoPane", // Change to suit your needs
    template: null, // Pass in inline HTML 
    render: function(infoPane, place, event){
      infoPane.html("I'm an infoPane - read about me below!&lt;br/&gt;&lt;a data-close href='#'&gt;Click me to close!&lt;/a&gt;");
    },
    places: [
      // ...
      { 
        title: 'In-N-Out Burger 7', 
        address: '1417 Fitzgerald Dr, Pinole, CA 94564', 
        events: { click: 'infoPane.open' }, 
      }
    ]
  }
});
          </code>
        </pre>
      </div>
    </article>

    <footer>
      <h1><a href='http://okbreathe.com'>okbreathe</a></h1>
    </footer>
  </div> <!-- #doc -->
  <div class='infoPane'></div>

  <script>
    window.map  = $("#map").okMap({
      events: {
        click: 'handleClick',
      },
      infoPane: { 
        render: function(ip){ 
          ip.html("I'm an infoPane - read about me below!<br/><a data-close href='#'>Click me to close!</a>");
        } 
      },
      places: [
        { title: 'In-N-Out Burger 1', address: '260 Washington St, Daly City, CA 94015' },
        { title: 'In-N-Out Burger 2', address: '15575 Hesperian Blvd, San Leandro, CA 94580' },
        { title: 'In-N-Out Burger 3', address: '333 Jefferson St, San Francisco, CA 94133' },
        { title: 'In-N-Out Burger 4', address: '8300 Oakport St, Oakland, CA 94621' },
        { title: 'In-N-Out Burger 5', address: '798 Redwood Hwy, Mill Valley, CA 94941' },
        { title: 'In-N-Out Burger 6', address: '11 Rollins Rd, Millbrae, California 94030' },
        { 
          title: 'In-N-Out Burger 7', 
          address: '1417 Fitzgerald Dr, Pinole, CA 94564', 
          events: { click: 'infoPane.open' }, 
        }
      ]
    });

    // A click handler method to the map instance
    var instance = $("#map").data('okMap');

    instance. handleClick = function(place,event){
      alert("You clicked: " + place.title);
    };

  </script>

</body>
</html>
